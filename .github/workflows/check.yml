name: check
on:
    workflow_dispatch:
    schedule:
        - cron: '0 4 * * 1,5' # kst, 1ì‹œ
jobs:
    check:
        runs-on: ubuntu-latest
        permissions:
            contents: read
        steps:
            - uses: actions/checkout@v6
            - uses: pnpm/action-setup@v4
            - uses: actions/setup-node@v6
              with:
                  node-version: 22
                  cache: 'pnpm'
                  cache-dependency-path: pnpm-lock.yaml
            - run: |
                  pnpm install --frozen-lockfile
                  pnpm exec puppeteer browsers install chrome
                  node check.js id=${{ secrets.LOTTO_ID }} pw=${{ secrets.LOTTO_PW }} url=${{ secrets.LOTTO_SLACK_URL }}
            - if: failure()
              uses: actions/upload-artifact@v4
              with:
                  name: check-login-debug-${{ github.run_id }}
                  path: .artifacts
                  if-no-files-found: ignore
            - uses: entepotenz/keep-github-actions-alive-min-dependencies@v1
